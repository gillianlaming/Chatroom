<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8"/>
      <title>chatroom</title>
      <script src="/socket.io/socket.io.js"></script>
      <link rel="stylesheet" href="public/chat.css">
    </head>

    <body>
      <div id="getUsername">
          <input type="text" id="username"/>
          <button onclick="sendUsername()">submit username</button>
      </div>

      <br><br>
      <div class="column left_column">
        <h3>rooms:</h3>
        <p>(click to visit)</p>
        <ul class="list" id="rooms_list"> <!-- should load in room names -->
          <li class="room_name"><button>{room 1}</button></li> <!-- each button activates the middle column -->
          <li class="room_name"><button>{room 2}</button></li>
          <li class="room_name"><button>{room 3}</button></li>
        </ul>
        <hr width="50%" style="margin-left: 0">
        <button id="add_room">add a room</button>
      </div>
      <div class="column middle_column" id="chatroom">
        <h1 id="room_title">this is room {name here} </h1><!-- when room is selected, append room name to this -->
        <div id="chatlog"></div><!-- should load in previous messages in this room  -->
        <div id="messenger">
          <input type="text" id="message_input"/>
          <button onclick="sendMessage()">send</button>
        </div>
      </div>
      <div class="column right_column" id="chatroom">
        <h3>users in this room:</h3>
        <p>(click to kick out or ban)</p>
          <ul class="list" id="users_list"> <!-- should add username once user joins room. also must broadcast change -->
              <li class="username"><button>{user 1}</button></li> <!-- buttons so clicking will make a pop up if user owns room -->
              <li class="username"><button>{user 2}</button></li>
              <li class="username"><button>{user 3}</button></li>
          </ul>
      </div>
   </body>

   <script>
      var socketio = io.connect();
      //var username = prompt('What\'s your username?');

      // socketio.on("get_username",fucntion(username){
        
      // });
     //git socketio.emit('little_newbie', username);
      

      socketio.on("message_to_client",function(data) {
         //Append an HR thematic break and the escaped HTML of the new message
         document.getElementById("chatlog").appendChild(document.createElement("hr"));
         //document.getElementById("chatlog").appendChild(document.createTextNode(data['username']));
         document.getElementById("chatlog").appendChild(document.createTextNode(data['message']));
         //document.getElementById("chatlog").appendChild(document.createTextNode(username['user']));
      });
      

      function sendUsername(){
        var username = document.getElementById("username").value;
        socketio.emit('little_newbie', username);
      }

      function sendMessage(){
         var msg = document.getElementById("message_input").value;
         //var username = prompt('What\'s your username?');
        //console.log(username);
         socketio.emit("message_to_server", {message:msg});
         //socketio.emit("message_to_server", username);
         //socketio.emit('little_newbie', {username:username});
      }
    </script>
</html>